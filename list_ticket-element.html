<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/paper-card/paper-card.html">
<link rel="import" href="bower_components/paper-button/paper-button.html">
<dom-module id="list_ticket-element">
    <template>
        <style is="custom-style">
            paper-card.rate {
                @apply(--layout-flex);
                margin: 5px -5PX 5PX -5PX;
            }
        </style>
        <iron-ajax
                id="ajaxPost"
                url="data/prices.json"
                last-response="{{prices}}"
                handle-as="json"
                on-response="handleResponse"></iron-ajax>
        <iron-signals on-iron-signal-current-operator="currentOperator"></iron-signals>
        <template is="dom-repeat" items="{{prices}}">
            <div class="small-12 medium-6 large-4 columns">
                <paper-card class="rate">
                    <div class="top-bar">
                        <div class="top-bar-left">
                            <div class="rate-header">
                                <iron-icon icon="{{item.icon}}"></iron-icon>
                                {{item.title}}
                            </div>
                        </div>
                    </div>
                    <div class="rate-content">
                        <div class="card-content">
                            <div class="rate-name">{{item.price}} â‚¬</div>
                            <div>{{item.definition}}</div>
                        </div>
                        <div class="card-actions">
                            <paper-button on-click="more" noink raised>
                                <iron-icon icon="add-shopping-cart"></iron-icon>
                                Ajouter
                            </paper-button>
                        </div>
                    </div>
                </paper-card>
            </div>
        </template>
    </template>
    <script>
        Polymer({
            is: 'list_ticket-element',
            ready: function () {
                this.prices = []
            },
            handleResponse: function (e, request) {
                this.prices = request.xhr.response;
            },
            listeners: {
                'currentOperator': 'currentOperator'
            },
            currentOperator: function (e, detail, sender) {
                this.$.ajaxPost.generateRequest();
            },
            more: function (e) {
                var model = e.model;
                this.fire('iron-signal', {name: "add-order", data: model.item});
            }
        });
    </script>
</dom-module>